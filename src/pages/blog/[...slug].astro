---
import Layout from '../../layouts/Layout.astro';
import BlogPost from '../../components/react-pages/BlogPost';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
    const posts = await getCollection('posts');
    return posts.map(post => ({
        params: { slug: post.slug },
        props: { post },
    }));
}

const { post } = Astro.props;
const { Content } = await render(post);
const postWithContent = {
    ...post.data,
    slug: post.slug,
    content: '' // React component will receive rendered HTML via children or specialized prop if refactored, but here we keep existing structure logic or adapt.
    // ACTUAL FIX: The React component expects `content` as a string of markdown.
    // With getCollection, `post.body` contains the raw markdown!
};
// Re-assign raw markdown to content for the React component (which uses ReactMarkdown)
postWithContent.content = post.body;
---

<Layout title={post.data.title} showHeader={false}>
    <BlogPost client:only="react" post={postWithContent} />
</Layout>
