<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A Brief Discussion on C++ auto - My Trantor</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap">
  <link rel="stylesheet" href="https://huangweiran.club/assets/css/custom.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css"/>
 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
        onload="renderMathInElement(document.body, {
          delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '\\(', right: '\\)', display: false},
            {left: '$', right: '$', display: false}
          ]
        });"></script><link rel="apple-touch-icon" sizes="180x180" href="https://huangweiran.club/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://huangweiran.club/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://huangweiran.club/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://huangweiran.club/images/favicon/site.webmanifest">
    <link rel="mask-icon" href="https://huangweiran.club/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#2d89ef">
    <meta name="theme-color" content="#ffffff"><link rel="canonical" href="https://huangweiran.club/blog/cpp-auto/" /><link rel="alternate" type="application/atom+xml"
        title="RSS" href="https://huangweiran.club/atom.xml"
      ><meta name="author" content="Weiran Huang"><meta name="description" content="Analysis of Usage and Type Deduction Rules" /><meta property="article:published_time" content='2023-11-01T00:34:00-05:00' /><meta name="generator" content="Zola">
  <meta property="og:title" content="A Brief Discussion on C++ auto" />
  <meta property="og:url" content="https://huangweiran.club/blog/cpp-auto/" /><meta property="og:description" content="Analysis of Usage and Type Deduction Rules" /><meta property="og:image" content="https://huangweiran.club/images/cpp-history.png" /><meta property="og:site_name" content="My Trantor" />
  <meta property="og:locale" content="en_US" />
  <meta name="twitter:card" content="summary" /><meta name="twitter:creator" content="@user" /><meta name="google-site-verification" content="0123457890abcdefg" />
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CNYGLH4HFP"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-CNYGLH4HFP');
    </script>
</head>
<body>
  <div class="container-fluid vh-100">
    <div class="row h-100"><div
    class="sidebar d-none d-lg-block col-lg-3 col-xl-2 mh-100 p-0 overflow-auto"
  >
    <aside class="d-flex flex-column justify-content-between h-100">
      <div class="d-none d-md-block mb-4 pt-5 px-4 text-center">
        <div class="sidebar-avatar mb-2 mx-auto border border-3 rounded-circle">
          <a href="https://huangweiran.club/" target="_blank" rel="noopener noreferrer">
    <img
      src="https://i.pinimg.com/736x/e7/d3/b6/e7d3b63a28a976d061696af520f80ee8.jpg"
      alt="Weiran Huang"
      class="img-fluid"
    >
  </a>
        </div>
        <div class="mb-1">
          <a
            href="https://huangweiran.club/"
            class="sidebar-title fs-5 fw-bold text-decoration-none"
          >
            My Trantor
          </a>
        </div>
        <div class="fw-light">
          Act Justly, Love Mercy, Walk Humbly.
        </div>
      </div>

      <div class="sidebar-nav list-group my-auto rounded-0 text-center"><a
            href="https://huangweiran.club/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="Home"
          >
          <span class="sidebar-nav-icon bi bi-house d-none fs-4"></span>
          <span class="sidebar-nav-text d-none d-md-inline">
            Home
          </span>
          </a><a
            href="https://huangweiran.club/blog/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="Blog"
          >
          <span class="sidebar-nav-icon bi bi-file-earmark-text d-none fs-4"></span>
          <span class="sidebar-nav-text d-none d-md-inline">
            Blog
          </span>
          </a><a
            href="https://huangweiran.club/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="Author"
          >
          <span class="sidebar-nav-icon bi bi-person d-none fs-4"></span>
          <span class="sidebar-nav-text d-none d-md-inline">
            Author
          </span>
          </a><a
            href="https://huangweiran.club/online-cv/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="About"
          >
          <span class="sidebar-nav-icon bi bi-question-octagon d-none fs-4"></span>
          <span class="sidebar-nav-text d-none d-md-inline">
            About
          </span>
          </a><a
            href="https://huangweiran.club/LifeCalendar/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="Calendar"
          >
          <span class="sidebar-nav-icon bi bi-calendar-date d-none fs-4"></span>
          <span class="sidebar-nav-text d-none d-md-inline">
            Calendar
          </span>
          </a><a
            href="https://huangweiran.club/Projects/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="Projects"
          >
          <span class="sidebar-nav-icon bi bi-code-slash d-none fs-4"></span>
          <span class="sidebar-nav-text d-none d-md-inline">
            Projects
          </span>
          </a></div>

      <div class="sidebar-social d-none d-md-block mt-4 pb-4 px-4">
        <div class="container-fluid">
          <div class="row justify-content-center">
            <div class="col-auto px-2">
        <a
          href="mailto:huangweiran1998@outlook.com"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='Email'
          class="text-decoration-none"
        >
          <span class="bi bi-envelope-fill"></span>
        </a>
      </div><div class="col-auto px-2">
        <a
          href="https://github.com/EtoDemerzel0427"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='GitHub'
          class="text-decoration-none"
        >
          <span class="bi bi-github"></span>
        </a>
      </div><div class="col-auto px-2">
        <a
          href="https://www.linkedin.com/in/weiranhuang"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='LinkedIn'
          class="text-decoration-none"
        >
          <span class="bi bi-linkedin"></span>
        </a>
      </div><div class="col-auto px-2">
        <a
          href="https://www.facebook.com/profile.php?id=100006603762815"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='Facebook'
          class="text-decoration-none"
        >
          <span class="bi bi-facebook"></span>
        </a>
      </div><div class="col-auto px-2">
        <a
          href="https://www.instagram.com/etodemerzel0427"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='Instagram'
          class="text-decoration-none"
        >
          <span class="bi bi-instagram"></span>
        </a>
      </div><div class="col-auto px-2">
        <a
          href="https://psnprofiles.com/eto-demerzel0427"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='Playstation'
          class="text-decoration-none"
        >
          <span class="bi bi-playstation"></span>
        </a>
      </div>
          </div>
        </div>
      </div>
    </aside>
  </div><div class="col mh-100 overflow-auto px-0"><nav
    class="navbar navbar-expand navbar-bg-light sticky-top border-bottom"
  >
    <div class="container-fluid"><button
        type="button"
        class="btn d-block d-lg-none fs-5"
        data-bs-toggle="offcanvas" data-bs-target="#offcanvas"
        aria-controls="offcanvas"
      >
        <span class="bi bi-list"></span>
      </button>
      
      <div class="col-8">
        
          <div class="row justify-content-center justify-content-lg-start p-2 ps-xl-3 text-center"><div class="col-auto d-none d-xl-block">
        <a
          href="https://huangweiran.club/blog/"
          class="text-decoration-none"
        >
          Blog
        </a>
      </div>
      <div class="col-auto d-none d-xl-block">
        <span class="text-secondary">
          »
        </span>
      </div><div class="col-auto">
      <span
        class="d-inline d-sm-none text-secondary"
        data-bs-toggle="tooltip"
        data-bs-title="A Brief Discussion on C++ auto"
      >
        A Brief Discussi…
      </span>
      <span
        class="d-none d-sm-inline text-secondary"
        data-bs-toggle="tooltip"
        data-bs-title="A Brief Discussion on C++ auto"
      >
        A Brief Discussion on C++ auto
      </span>
    </div>
  </div>
        
      </div>

      <!-- Add language toggle button here -->
      
      <div class="d-flex ms-auto">
        <button type="button" class="btn btn-link border-0 text-dark" id="language-toggler">
    <i class="bi bi-globe2 fs-5 fs-md-4 fs-lg-5"></i>
  </button>
        <button
    type="button" data-bs-toggle="modal" data-bs-target="#searchModal"
    class="btn border border-0"
  >
    <span class="bi bi-search fs-5"></span>
  </button>
      </div>
    </div>
  </nav><div class="d-flex flex-column h-100"><main class="container">
    <div class="row justify-content-center mt-5">
      <div class="col-11 col-lg-10 col-xxl-9">
        <h1 class="mb-3">
          A Brief Discussion on C++ auto
        </h1>
        <div class="row mt-3 mb-2">
          <div class="col-auto">
            <small class="text-muted">
              By:
              <a
                href="https://huangweiran.club/"
                target="_blank" rel="noopener noreferrer"
                class="text-decoration-none"
              >
                Weiran Huang
              </a>
            </small>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-auto mb-2">
            <small class="text-muted">
              Posted:
              <time datetime="2023-11-01T00:34:00-05:00">
                <a 
                  href="#" data-bs-toggle="tooltip"
                  data-bs-title="Wednesday, November 01, 2023 12:34:00 AM -05:00"
                  class="text-muted text-decoration-none"
                >
                  November 01, 2023
                </a>
              </time>
            </small>
          </div>
          
        </div><div class="post-img mb-4 rounded-3">
            <img
              src="https://huangweiran.club/images/cpp-history.png"
              class="img-fluid"
              alt="code-img"
            >
          </div><div class="mb-5">
          <blockquote>
<p>This English vesion is a translation of the original Chinese article. It is translated by ChatGPT w/o any human proofreading. If you find any mistakes, please let me know.</p>
</blockquote>
<p>The <code>auto</code> keyword has actually existed since the C language, where it was used to indicate that a variable had <a rel="noopener nofollow noreferrer" target="_blank" href="https://en.cppreference.com/w/cpp/language/storage_duration">automatic storage duration</a>, meaning that the variable is created when the block of code in which it is declared is entered and destroyed when that block is exited. However, since this is the default behavior for local variables, it was rarely used. Bjarne Stroustrup, the father of C++, cleverly repurposed this existing keyword in C++11 and gave it a new meaning: <strong>automatic type deduction</strong>. <code>auto</code> is very useful when dealing with complex types (such as various iterators) and variables that are difficult or even impossible to write out precisely (such as lambdas).</p>
<!--more-->
<h2 id="basic-syntax">Basic Syntax</h2>
<p>The <code>auto</code> keyword allows the compiler to automatically deduce the type of a variable based on the initialization expression. Here are some basic usage examples:</p>
<ol>
<li>Direct deduction from a value:<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++"><span class="z-storage z-type z-c">auto</span> x <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-float z-decimal z-c++">3<span class="z-punctuation z-separator z-decimal z-c++">.</span>14</span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> x is of type double
</span><span class="z-storage z-type z-c">auto</span> y <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">42</span><span class="z-punctuation z-terminator z-c++">;</span>   <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> y is of type int
</span><span class="z-storage z-type z-c">auto</span> <span class="z-meta z-function z-c++"><span class="z-meta z-toc-list z-full-identifier z-c++"><span class="z-entity z-name z-function z-c++">z</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>     <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> z is of type int
</span></span></code></pre>
</li>
<li>Deduction from an expression:<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++"><span class="z-storage z-type z-c">int</span> <span class="z-meta z-function z-c++"><span class="z-meta z-toc-list z-full-identifier z-c++"><span class="z-entity z-name z-function z-c++">foo</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span> x1 <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">foo</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> x1 : int
</span></span></code></pre>
</li>
<li>Deduction involving cv-qualifiers, references, or pointers:<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++"><span class="z-storage z-modifier z-c++">const</span> <span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span> x2 <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">foo</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> x2 : const int&amp; 
</span><span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span> x3 <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">foo</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> x3 : int&amp; - Error, cannot bind reference to temporary object
</span>
<span class="z-storage z-type z-c">float</span><span class="z-keyword z-operator z-c++">&amp;</span> <span class="z-meta z-function z-c++"><span class="z-meta z-toc-list z-full-identifier z-c++"><span class="z-entity z-name z-function z-c++">bar</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span> y1 <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">bar</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> y1 : float
</span><span class="z-storage z-modifier z-c++">const</span> <span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span> y2 <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">bar</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> y2 : const float&amp; 
</span><span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span> y3 <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">bar</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> y3 : float&amp;
</span>
A<span class="z-keyword z-operator z-c++">*</span> <span class="z-meta z-function z-c++"><span class="z-meta z-toc-list z-full-identifier z-c++"><span class="z-entity z-name z-function z-c++">fii</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">*</span> z1 <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">fii</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> z1 : A*
</span><span class="z-storage z-type z-c">auto</span> z2 <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">fii</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> z2 : A*
</span><span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">*</span> z3 <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">bar</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Error, bar does not return a pointer type
</span></span></code></pre>
From the above examples, the type deduction rules of <code>auto</code> start to become apparent, which we will discuss in detail in the next section. It is also worth noting that const references can bind to temporary objects (<code>const auto&amp; x2 = foo()</code>), whereas non-const references cannot. Semantically, modifying a temporary object makes no sense; in terms of lifespan, allowing non-const references to bind to temporaries would result in dangling references after the temporary object is destroyed, whereas const references extend the temporary object's lifespan to match the reference's.<sup id="a1"><a href="https://huangweiran.club/blog/cpp-auto/#f1">1</a></sup></li>
<li>Multiple variable declarations:<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++"><span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Multiple variable declarations
</span><span class="z-storage z-type z-c">auto</span> a <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-separator z-c++">,</span> <span class="z-keyword z-operator z-c">*</span>b <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-keyword z-operator z-c">&amp;</span>a<span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Valid, declarations are processed from left to right
</span><span class="z-storage z-type z-c">auto</span> x <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-separator z-c++">,</span> <span class="z-keyword z-operator z-c">*</span>y <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-keyword z-operator z-c">&amp;</span>x<span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Also valid, declarations are processed from left to right
</span><span class="z-storage z-type z-c">auto</span> m <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-separator z-c++">,</span> y <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-float z-decimal z-c++">3<span class="z-punctuation z-separator z-decimal z-c++">.</span>14</span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Error, types are not compatible
</span></span></code></pre>
In multiple variable declarations, the type of <code>auto</code> is deduced from the first declaration, and subsequent declarations must be compatible. This is because declarations are processed from left to right.</li>
<li>Use in dynamic allocation:<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++"><span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">*</span> p <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-keyword z-control z-c++">new</span> <span class="z-storage z-type z-c">auto</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span><span class="z-punctuation z-terminator z-c++">;</span>  <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Using auto in dynamic allocation
</span></span></code></pre>
This is an uncommon but valid syntax.</li>
</ol>
<h2 id="type-deduction-rules">Type Deduction Rules</h2>
<blockquote>
<p>The code covered in this section can be found <a rel="noopener nofollow noreferrer" target="_blank" href="https://github.com/EtoDemerzel0427/LangLawyer/blob/main/auto-deduce.cpp">here</a>.</p>
</blockquote>
<p>The type deduction rules of <code>auto</code> are actually consistent with the template parameter deduction rules. This means that, for:</p>
<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++"><span class="z-meta z-template z-c++"><span class="z-storage z-type z-template z-c++">template</span><span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span></span><span class="z-meta z-template z-c++"><span class="z-storage z-type z-c++">typename</span> T</span><span class="z-meta z-template z-c++"><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span></span>
<span class="z-storage z-type z-c">void</span> <span class="z-meta z-function z-c++"><span class="z-meta z-toc-list z-full-identifier z-c++"><span class="z-entity z-name z-function z-c++">foo</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++">T <span class="z-variable z-parameter z-c++">param</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>

<span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">foo</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">expr</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>    <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Deduction process of T
</span><span class="z-storage z-type z-c">auto</span> x <span class="z-keyword z-operator z-assignment z-c">=</span> expr<span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Deduction process of the type of x
</span></span></code></pre>
<p>The process of deducing the template parameter <code>T</code> in <code>foo(expr)</code> follows the same rules as the process of deducing the type of <code>x</code> in <code>auto x = expr</code>. These rules can be divided into the following three cases:</p>
<ul>
<li>
<p><strong>Declaration of the form <code>auto x = expr</code></strong>:</p>
<ol>
<li>Discard reference qualification of <code>expr</code></li>
<li>Discard top-level <code>const</code> qualifier of <code>expr</code></li>
<li>Arrays decay to pointers</li>
<li>Functions decay to function pointers</li>
</ol>
<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++"><span class="z-storage z-modifier z-c++">const</span> <span class="z-storage z-type z-c">int</span> a <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">42</span><span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span> b <span class="z-keyword z-operator z-assignment z-c">=</span> a<span class="z-punctuation z-terminator z-c++">;</span>      <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> b is of type int, const is discarded
</span>
<span class="z-storage z-modifier z-c++">const</span> <span class="z-storage z-type z-c">int</span><span class="z-keyword z-operator z-c++">&amp;</span> c <span class="z-keyword z-operator z-assignment z-c">=</span> a<span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span> d <span class="z-keyword z-operator z-assignment z-c">=</span> c<span class="z-punctuation z-terminator z-c++">;</span>      <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> d is of type int, both const and reference are discarded
</span>
<span class="z-storage z-type z-c">int</span> arr<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span><span class="z-constant z-numeric z-integer z-decimal z-c++">10</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span> e <span class="z-keyword z-operator z-assignment z-c">=</span> arr<span class="z-punctuation z-terminator z-c++">;</span>    <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> e is of type int*, array decays to pointer
</span>
<span class="z-storage z-type z-c">void</span> <span class="z-meta z-function z-c++"><span class="z-meta z-toc-list z-full-identifier z-c++"><span class="z-entity z-name z-function z-c++">foo</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span> f <span class="z-keyword z-operator z-assignment z-c">=</span> foo<span class="z-punctuation z-terminator z-c++">;</span>    <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> f is of type void(*)(), function decays to function pointer
</span></span></code></pre>
</li>
<li>
<p><strong>Declaration of the form <code>auto&amp; x = expr</code> (reference deduction)</strong>: It is obvious that <code>x</code> is of reference type, and the rules for deducing the type of the reference are:</p>
<ol>
<li>Keep the <code>const</code> qualifier of <code>expr</code></li>
<li>If <code>expr</code> itself is a reference, use its underlying type</li>
<li>No array or function decay occurs</li>
</ol>
<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++"><span class="z-storage z-modifier z-c++">const</span> <span class="z-storage z-type z-c">int</span> a <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">42</span><span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span> b <span class="z-keyword z-operator z-assignment z-c">=</span> a<span class="z-punctuation z-terminator z-c++">;</span>     <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> b is of type const int&amp;
</span>
<span class="z-storage z-type z-c">int</span><span class="z-keyword z-operator z-c++">&amp;</span> c <span class="z-keyword z-operator z-assignment z-c">=</span> a<span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span> d <span class="z-keyword z-operator z-assignment z-c">=</span> c<span class="z-punctuation z-terminator z-c++">;</span>     <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> d is of type int&amp;
</span>
<span class="z-storage z-type z-c">int</span> arr<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span><span class="z-constant z-numeric z-integer z-decimal z-c++">10</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span> e <span class="z-keyword z-operator z-assignment z-c">=</span> arr<span class="z-punctuation z-terminator z-c++">;</span>    <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> e is of type int(&amp;)[10]
</span>
<span class="z-storage z-type z-c">void</span> <span class="z-meta z-function z-c++"><span class="z-meta z-toc-list z-full-identifier z-c++"><span class="z-entity z-name z-function z-c++">foo</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span> f <span class="z-keyword z-operator z-assignment z-c">=</span> foo<span class="z-punctuation z-terminator z-c++">;</span>    <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> f is of type void(&amp;)()
</span></span></code></pre>
</li>
<li>
<p><strong>Declaration of the form <code>auto&amp;&amp; x = expr</code> (universal reference deduction)</strong></p>
<p>This case is a bit more complex. First of all, <code>auto&amp;&amp;</code> (or <code>T&amp;&amp;</code> in template parameter deduction) is a universal reference, meaning it can match an lvalue or an rvalue. During type deduction:</p>
<ol>
<li>If <code>expr</code> is an lvalue (assuming its type is <code>param_t</code>), <code>auto</code> is deduced as <code>param_t&amp;</code> (a left reference).</li>
<li>If <code>expr</code> is an rvalue, <code>auto</code> is deduced as a non-reference type, i.e., <code>param_t</code> (following the same rules as <code>auto&amp; x = expr</code>).</li>
<li>After this, when the compiler substitutes the deduced type into <code>auto&amp;&amp;</code> or <code>T&amp;&amp;</code> (imagine we get a type of <code>param_t&amp; &amp;&amp;</code> or <code>param_t&amp;&amp;</code>), reference collapsing occurs. The rule for reference collapsing is quite simple: <strong>if at least one of the two references is an lvalue reference, the result is an lvalue reference; otherwise, it is an rvalue reference</strong>. This means that <code>T&amp;&amp; &amp;&amp;</code> collapses to <code>T&amp;&amp;</code>, <code>T&amp; &amp;&amp;</code> collapses to <code>T&amp;</code>, <code>T&amp;&amp; &amp;</code> collapses to <code>T&amp;</code>, and <code>T&amp; &amp;</code> collapses to <code>T&amp;</code> (the latter two cases do not appear in <code>auto&amp;&amp;</code> deduction).</li>
</ol>
<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++"><span class="z-storage z-type z-c">int</span> a <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">42</span><span class="z-punctuation z-terminator z-c++">;</span>
<span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span><span class="z-keyword z-operator z-c++">&amp;</span> b <span class="z-keyword z-operator z-assignment z-c">=</span> a<span class="z-punctuation z-terminator z-c++">;</span>     <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> a is an lvalue, auto is deduced as int&amp;, resulting in int&amp; &amp;&amp;, which collapses to int&amp;
</span>
<span class="z-storage z-type z-c">int</span><span class="z-keyword z-operator z-c++">&amp;</span><span class="z-keyword z-operator z-c++">&amp;</span> rref <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">42</span><span class="z-punctuation z-terminator z-c++">;</span>     <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> rref is an rvalue reference, but it itself is an lvalue
</span><span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span><span class="z-keyword z-operator z-c++">&amp;</span> r <span class="z-keyword z-operator z-assignment z-c">=</span> rref<span class="z-punctuation z-terminator z-c++">;</span>     <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> auto is deduced as int&amp;, resulting in int&amp; &amp;&amp;, which collapses to int&amp;
</span>
<span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span><span class="z-keyword z-operator z-c++">&amp;</span> c <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">42</span><span class="z-punctuation z-terminator z-c++">;</span>     <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> 42 is an rvalue, auto is deduced as int, resulting in int&amp;&amp;
</span>
<span class="z-storage z-type z-c">auto</span><span class="z-keyword z-operator z-c++">&amp;</span><span class="z-keyword z-operator z-c++">&amp;</span> d <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-function-call z-c++">std<span class="z-punctuation z-accessor z-double-colon z-c++">::</span><span class="z-variable z-function z-c++">move</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++">a</span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>  <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> std::move(a) is an rvalue, auto is deduced as int, resulting in int&amp;&amp; &amp;&amp;, which collapses to int&amp;&amp;
</span></span></code></pre>
</li>
</ul>
<h2 id="further-reading">Further Reading</h2>
<ul>
<li><em>Effective Modern C++</em> by Scott Meyers, Item 2: Understand auto type deduction.</li>
<li>cppreference.com, <a rel="noopener nofollow noreferrer" target="_blank" href="https://en.cppreference.com/w/cpp/language/auto">auto specifier</a>.</li>
</ul>
<h2 id="footnotes">Footnotes</h2>
<div id="f1">
  <sup>[1]</sup> 
  For class member references, the compiler cannot safely extend the lifetime of a temporary object to the lifetime of the entire class object. Therefore:
<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++">  <span class="z-meta z-struct z-c++"><span class="z-storage z-type z-c++">struct</span> </span><span class="z-meta z-struct z-c++"><span class="z-entity z-name z-struct z-c++">S</span></span><span class="z-meta z-struct z-c++"> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span></span></span><span class="z-meta z-struct z-c++"><span class="z-meta z-block z-c++">
      <span class="z-storage z-modifier z-c++">const</span> <span class="z-storage z-type z-c">int</span><span class="z-keyword z-operator z-c++">&amp;</span> ref<span class="z-punctuation z-terminator z-c++">;</span>
      <span class="z-meta z-method z-constructor z-c++"><span class="z-entity z-name z-function z-constructor z-c++">S</span></span><span class="z-meta z-method z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-meta z-method z-c++"> </span><span class="z-meta z-method z-constructor z-initializer-list z-c++"><span class="z-punctuation z-separator z-initializer-list z-c++">:</span> <span class="z-variable z-other z-readwrite z-member z-c++">ref</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span><span class="z-meta z-group z-c++"><span class="z-constant z-numeric z-integer z-decimal z-c++">42</span></span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span> </span><span class="z-meta z-method z-c++"><span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span></span></span><span class="z-meta z-method z-c++"><span class="z-meta z-block z-c++"> </span></span><span class="z-meta z-method z-c++"><span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-end z-c++">}</span></span></span>  <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Dangerous: member reference binds to a temporary object
</span>  </span></span><span class="z-meta z-struct z-c++"><span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-end z-c++">}</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>  <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> The temporary object is destroyed when the constructor ends
</span></span></code></pre>
<p>is incorrect. <a href="#a1">↩</a></p>
</div>

        </div>
        
        
      </div>
    </div>
  </main><div class="container">
    <div class="row justify-content-center mt-3 mb-4">
      <div class="col-11 col-lg-10 col-xxl-9"><div id="disqus_thread"></div>
  <script>        
    var disqus_config = function () {
      this.page.url = 'https://huangweiran.club/blog/cpp-auto/';  

      this.page.identifier = 'decltype-auto'; 
    };
    
    (function() {
      var d = document, s = d.createElement('script');
      
      s.src = 'https://user.disqus.com/embed.js';
      
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>
    Please enable JavaScript to view the 
    <a href="https://disqus.com/?ref_noscript" rel="nofollow">
      comments powered by Disqus.
    </a>
  </noscript></div>
    </div>
  </div><footer class="container-fluid mt-auto">
    <div class="row justify-content-center">
      <div class="col-10">
        <div class="row pt-3 pb-4 border-top">
          <div class="col-12 col-md-6 mb-2 mb-md-0 text-center text-md-start">
            <small class="text-secondary">
              © 2024
              <a 
                href="https://huangweiran.club/"
                target="_blank" rel="noopener noreferrer"
                class="text-decoration-none"
              >
                Weiran Huang&period;
              </a>
              <a
                href="https://creativecommons.org/licenses/by/4.0/"
                data-bs-toggle="tooltip"
                data-bs-title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
                class="text-secondary text-decoration-none"
              >
                Some rights reserved.
              </a>
            </small>
          </div>
          <div class="col-12 col-md-6 text-center text-md-end">
            <small class="text-secondary">
              Powered by
              <a 
                href="https://www.getzola.org/"
                target="_blank" rel="noopener noreferrer"
                class="text-decoration-none"
              >
                Zola
              </a>
              with
              <a 
                href="https://github.com/gersonbdev/ataraxia-zola"
                target="_blank" rel="noopener noreferrer"
                class="text-decoration-none"
              >
                Ataraxia
              </a>
              theme.
            </small>
          </div>
        </div>
      </div>
    </div>
  </footer>
        </div>
      </div>
    </div>
  </div>
  <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvas" aria-labelledby="offcanvasLabel">
    <div class="offcanvas-body p-0">
      <div class="sidebar container-fluid vh-100">
        <div class="row h-100">
          <div
            class="col mh-100 px-0 overflow-auto"
          >
            <aside class="d-flex flex-column justify-content-between h-100">
              <div class="mb-4 pt-5 px-3 text-center">
                <div class="sidebar-avatar mb-2 mx-auto border border-3 rounded-circle">
                  <a href="https://huangweiran.club/" target="_blank" rel="noopener noreferrer">
    <img
      src="https://i.pinimg.com/736x/e7/d3/b6/e7d3b63a28a976d061696af520f80ee8.jpg"
      alt="Weiran Huang"
      class="img-fluid"
    >
  </a>
                </div>
                <div>
                  <a
                    href="https://huangweiran.club/"
                    class="sidebar-title fs-5 fw-bold text-decoration-none"
                  >
                    My Trantor
                  </a>
                </div>
              </div>

              <div class="sidebar-nav list-group my-auto rounded-0 text-start"><a
            href="https://huangweiran.club/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="Home"
          >
          <span class="sidebar-nav-icon bi bi-house ms-2 me-1 fs-4"></span>
          <span class="sidebar-nav-text">Home</span>
          </a><a
            href="https://huangweiran.club/blog/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="Blog"
          >
          <span class="sidebar-nav-icon bi bi-file-earmark-text ms-2 me-1 fs-4"></span>
          <span class="sidebar-nav-text">Blog</span>
          </a><a
            href="https://huangweiran.club/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="Author"
          >
          <span class="sidebar-nav-icon bi bi-person ms-2 me-1 fs-4"></span>
          <span class="sidebar-nav-text">Author</span>
          </a><a
            href="https://huangweiran.club/online-cv/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="About"
          >
          <span class="sidebar-nav-icon bi bi-question-octagon ms-2 me-1 fs-4"></span>
          <span class="sidebar-nav-text">About</span>
          </a><a
            href="https://huangweiran.club/LifeCalendar/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="Calendar"
          >
          <span class="sidebar-nav-icon bi bi-calendar-date ms-2 me-1 fs-4"></span>
          <span class="sidebar-nav-text">Calendar</span>
          </a><a
            href="https://huangweiran.club/Projects/"
            class="sidebar-nav-item list-group-item list-group-item-action border border-0"
            data-bs-toggle="tooltip" data-bs-title="Projects"
          >
          <span class="sidebar-nav-icon bi bi-code-slash ms-2 me-1 fs-4"></span>
          <span class="sidebar-nav-text">Projects</span>
          </a></div>

              <div class="sidebar-social mt-4 pb-4 px-3">
                <div class="container-fluid">
                  <div class="row justify-content-center">
                    <div class="col-auto px-2">
        <a
          href="mailto:huangweiran1998@outlook.com"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='Email'
          class="text-decoration-none"
        >
          <span class="bi bi-envelope-fill"></span>
        </a>
      </div><div class="col-auto px-2">
        <a
          href="https://github.com/EtoDemerzel0427"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='GitHub'
          class="text-decoration-none"
        >
          <span class="bi bi-github"></span>
        </a>
      </div><div class="col-auto px-2">
        <a
          href="https://www.linkedin.com/in/weiranhuang"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='LinkedIn'
          class="text-decoration-none"
        >
          <span class="bi bi-linkedin"></span>
        </a>
      </div><div class="col-auto px-2">
        <a
          href="https://www.facebook.com/profile.php?id=100006603762815"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='Facebook'
          class="text-decoration-none"
        >
          <span class="bi bi-facebook"></span>
        </a>
      </div><div class="col-auto px-2">
        <a
          href="https://www.instagram.com/etodemerzel0427"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='Instagram'
          class="text-decoration-none"
        >
          <span class="bi bi-instagram"></span>
        </a>
      </div><div class="col-auto px-2">
        <a
          href="https://psnprofiles.com/eto-demerzel0427"
          target="_blank" rel="noopener noreferrer"
          data-bs-toggle="tooltip"
          data-bs-title='Playstation'
          class="text-decoration-none"
        >
          <span class="bi bi-playstation"></span>
        </a>
      </div>
                  </div>
                </div>
              </div>
            </aside>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="searchModalLabel">
          Search
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div
          id="searchInput" role="search" 
          class="d-flex mb-3 border rounded-5 bg-white"
        >
          <input
            id="search" type="search"
            class="form-control border border-0 rounded-5 rounded-end"
            placeholder="Search"
            aria-label="Search"
          >
          <div class="rounded-5 rounded-start py-2 ps-2 pe-3">
            <span class="bi bi-search"></span>
          </div>
        </div>
        <div class="search-results">
          <div class="search-results__items">
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <script src="https://huangweiran.club/assets/js/bootstrap/bootstrap.bundle.min.js"></script>
  <script>
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
    const myModal = document.getElementById('searchModal');
    const myInput = document.getElementById('searchInput');

    myModal.addEventListener('shown.bs.modal', () => {
      myInput.focus()
    });
  </script>
  <script>
    hljs.highlightAll();
    hljs.addPlugin(new CopyButtonPlugin());
</script>
  <script>
    function toggleLanguage() {
        const currentUrl = new URL(window.location.href);
        const pathSegments = currentUrl.pathname.split('/').filter(segment => segment);
        
        if (pathSegments[0] === 'zh') {
            pathSegments.shift();
        } else {
            pathSegments.unshift('zh');
        }
        
        currentUrl.pathname = '/' + pathSegments.join('/');
        window.location.href = currentUrl.href;
    }
    
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('language-toggler').addEventListener('click', toggleLanguage);
    });
  </script>
  const lang = document.documentElement.lang;
  console.log(lang);
  <script src="https://huangweiran.club/elasticlunr.min.js"></script><script src="https://huangweiran.club/search_index.en.js"></script><script src="https://huangweiran.club/assets/js/search/search.js"></script>
</body>
</html>